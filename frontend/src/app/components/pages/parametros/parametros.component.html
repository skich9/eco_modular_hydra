<!-- Parámetros del Sistema Component -->
<div class="parametros-container">
	<!-- Header Section -->
	<div class="parametros-header">
		<div class="container-fluid px-4 py-4">
			<div class="d-flex align-items-center">
				<div class="parametros-icon me-3">
					<i class="fas fa-cogs"></i>
				</div>
				<div>
					<h1 class="parametros-title mb-1">Parámetros del Sistema</h1>
					<p class="parametros-subtitle mb-0">Configuración de parámetros económicos y elementos de cobro</p>
				</div>
			</div>
		</div>
	</div>

	<!-- Guide Section -->
	<div class="parametros-guide">
		<div class="container-fluid px-4 py-3">
			<div class="guide-content">
				<div class="guide-icon me-3">
					<i class="fas fa-info-circle"></i>
				</div>
				<div>
					<h6 class="guide-title mb-1">Guía de Configuración</h6>
					<p class="guide-description mb-0">Configure los parámetros del sistema para optimizar el funcionamiento de los cobros y gestión académica del Instituto CETA.</p>
				</div>
			</div>
			
			<div class="row mt-4">
				<div class="col-md-4">
					<div class="guide-card">
						<h6 class="guide-card-title">Parámetros del Sistema</h6>
						<p class="guide-card-text">Configuraciones generales que afectan el comportamiento del sistema académico.</p>
					</div>
				</div>
				<div class="col-md-4">
					<div class="guide-card">
						<h6 class="guide-card-title">Parámetros Económicos</h6>
						<p class="guide-card-text">Tasas, comisiones y descuentos aplicables a las transacciones financieras.</p>
					</div>
				</div>
				<div class="col-md-4">
					<div class="guide-card">
						<h6 class="guide-card-title">Items de Cobro</h6>
						<p class="guide-card-text">Elementos específicos que pueden ser cobrados a los estudiantes.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Tabs Navigation -->
	<div class="parametros-tabs">
		<div class="container-fluid px-4">
			<nav class="nav nav-tabs">
				<button 
					class="nav-link" 
					[class.active]="activeTab === 'sistema'"
					(click)="setActiveTab('sistema')"
				>
					<i class="fas fa-cog me-2"></i>Parámetros del Sistema
				</button>
				<button 
					class="nav-link" 
					[class.active]="activeTab === 'economicos'"
					(click)="setActiveTab('economicos')"
				>
					<i class="fas fa-dollar-sign me-2"></i>Parámetros Económicos
				</button>
				<button 
					class="nav-link" 
					[class.active]="activeTab === 'items'"
					(click)="setActiveTab('items')"
				>
					<i class="fas fa-receipt me-2"></i>Items de Cobro
				</button>
			</nav>
		</div>
	</div>

	<!-- Content Section -->
	<div class="parametros-content">
		<div class="container-fluid px-4 py-4">
			<!-- Alert Messages -->
			<div *ngIf="alertMessage" class="alert" [ngClass]="'alert-' + alertType" role="alert">
				{{ alertMessage }}
			</div>

			<!-- Loading State -->
			<div *ngIf="loading" class="d-flex justify-content-center p-4">
				<div class="spinner-border text-primary" role="status">
					<span class="visually-hidden">Cargando...</span>
				</div>
			</div>

			<!-- Tab Content -->
			<div *ngIf="!loading" class="tab-content">
				<!-- Parámetros del Sistema Tab -->
				<div *ngIf="activeTab === 'sistema'" class="tab-pane active">
					<div class="content-section">
						<div class="section-header">
							<h5 class="section-title">Parámetros del Sistema</h5>
							<p class="section-subtitle">Configuraciones generales del sistema académico</p>
						</div>

						<div class="d-flex justify-content-between align-items-center mb-3">
							<div class="search-container">
								<div class="input-group">
									<span class="input-group-text">
										<i class="fas fa-search"></i>
									</span>
									<input 
										type="text" 
										class="form-control" 
										placeholder="Buscar parámetros..."
										[(ngModel)]="searchTerm"
										(input)="filterData()"
									>
								</div>
							</div>
							<button type="button" class="btn btn-primary" (click)="openCreateModal('sistema')">
								<i class="fas fa-plus me-2"></i>Nuevo Parámetro
							</button>
						</div>

						<!-- Table -->
						<div class="table-container">
							<table class="table table-dark table-hover">
								<thead>
									<tr>
										<th>N°</th>
										<th>Pensum</th>
										<th>Parámetro</th>
										<th>Valor</th>
										<th>Estado</th>
										<th>Módulo</th>
										<th>Acciones</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let item of getFilteredData('sistema'); let i = index">
										<td>{{ i + 1 }}</td>
										<td><span class="badge bg-info">{{ item.pensum }}</span></td>
										<td>{{ item.parametro }}</td>
										<td>{{ item.valor }}</td>
										<td>
											<span class="badge" [ngClass]="item.estado === 'Activo' ? 'bg-success' : 'bg-secondary'">
												{{ item.estado }}
											</span>
										</td>
										<td>{{ item.modulo }}</td>
										<td>
											<button type="button" class="btn btn-sm btn-outline-light me-1" (click)="openEditModal('sistema', item)">
												<i class="fas fa-edit"></i>
											</button>
											<button type="button" class="btn btn-sm btn-outline-danger" (click)="openDeleteModal('sistema', item)">
												<i class="fas fa-trash"></i>
											</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<!-- Parámetros Económicos Tab -->
				<div *ngIf="activeTab === 'economicos'" class="tab-pane active">
					<div class="content-section">
						<div class="section-header">
							<h5 class="section-title">Parámetros Económicos</h5>
							<p class="section-subtitle">Tasas, comisiones y descuentos aplicables a las transacciones financieras</p>
						</div>

						<div class="d-flex justify-content-between align-items-center mb-3">
							<div class="search-container">
								<div class="input-group">
									<span class="input-group-text">
										<i class="fas fa-search"></i>
									</span>
									<input 
										type="text" 
										class="form-control" 
										placeholder="Buscar parámetros..."
										[(ngModel)]="searchTerm"
										(input)="filterData()"
									>
								</div>
							</div>
							<button type="button" class="btn btn-primary" (click)="openCreateModal('economicos')">
								<i class="fas fa-plus me-2"></i>Nuevo Parámetro
							</button>
						</div>

						<!-- Table -->
						<div class="table-container">
							<table class="table table-dark table-hover">
								<thead>
									<tr>
										<th>N°</th>
										<th>Pensum</th>
										<th>Parámetro</th>
										<th>Valor</th>
										<th>Estado</th>
										<th>Módulo</th>
										<th>Acciones</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let item of getFilteredData('economicos'); let i = index">
										<td>{{ i + 1 }}</td>
										<td><span class="badge bg-info">{{ item.pensum }}</span></td>
										<td>{{ item.parametro }}</td>
										<td>{{ item.valor }}</td>
										<td>
											<span class="badge" [ngClass]="item.estado === 'Activo' ? 'bg-success' : 'bg-secondary'">
												{{ item.estado }}
											</span>
										</td>
										<td>{{ item.modulo }}</td>
										<td>
											<button type="button" class="btn btn-sm btn-outline-light me-1" (click)="openEditModal('economicos', item)">
												<i class="fas fa-edit"></i>
											</button>
											<button type="button" class="btn btn-sm btn-outline-danger" (click)="openDeleteModal('economicos', item)">
												<i class="fas fa-trash"></i>
											</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<!-- Items de Cobro Tab -->
				<div *ngIf="activeTab === 'items'" class="tab-pane active">
					<div class="content-section">
						<div class="section-header">
							<h5 class="section-title">Items de Cobro</h5>
							<p class="section-subtitle">Elementos específicos que pueden ser cobrados a los estudiantes</p>
						</div>

						<div class="d-flex justify-content-between align-items-center mb-3">
							<div class="search-container">
								<div class="input-group">
									<span class="input-group-text">
										<i class="fas fa-search"></i>
									</span>
									<input 
										type="text" 
										class="form-control" 
										placeholder="Buscar items..."
										[(ngModel)]="searchTerm"
										(input)="filterData()"
									>
								</div>
							</div>
							<button type="button" class="btn btn-primary" (click)="openCreateModal('items')">
								<i class="fas fa-plus me-2"></i>Nuevo Item
							</button>
						</div>

						<!-- Table -->
						<div class="table-container">
							<table class="table table-dark table-hover">
								<thead>
									<tr>
										<th>N°</th>
										<th>Pensum</th>
										<th>Parámetro</th>
										<th>Valor</th>
										<th>Estado</th>
										<th>Módulo</th>
										<th>Acciones</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let item of getFilteredData('items'); let i = index">
										<td>{{ i + 1 }}</td>
										<td><span class="badge bg-info">{{ item.pensum }}</span></td>
										<td>{{ item.parametro }}</td>
										<td>{{ item.valor }}</td>
										<td>
											<span class="badge" [ngClass]="item.estado === 'Activo' ? 'bg-success' : 'bg-secondary'">
												{{ item.estado }}
											</span>
										</td>
										<td>{{ item.modulo }}</td>
										<td>
											<button type="button" class="btn btn-sm btn-outline-light me-1" (click)="openEditModal('items', item)">
												<i class="fas fa-edit"></i>
											</button>
											<button type="button" class="btn btn-sm btn-outline-danger" (click)="openDeleteModal('items', item)">
												<i class="fas fa-trash"></i>
											</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Modal Parámetro Económico -->
<div class="modal fade" [class.show]="showModal" [style.display]="showModal ? 'block' : 'none'">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">{{ editingItem ? 'Editar' : 'Nuevo' }} Parámetro</h5>
				<button type="button" class="btn-close" (click)="closeModals()"></button>
			</div>
			<form [formGroup]="itemForm" (ngSubmit)="saveItem()">
				<div class="modal-body">
					<div class="mb-3">
						<label class="form-label">Nombre *</label>
						<input type="text" class="form-control" formControlName="nombre">
					</div>
					<div class="mb-3">
						<label class="form-label">Descripción</label>
						<textarea class="form-control" formControlName="descripcion" rows="3"></textarea>
					</div>
					<div class="mb-3">
						<label class="form-label">Valor *</label>
						<input type="number" class="form-control" formControlName="valor">
					</div>
					<div class="mb-3">
						<label class="form-label">Tipo *</label>
						<select class="form-select" formControlName="tipo">
							<option value="">Seleccione un tipo</option>
							<option value="MONETARIO">Monetario</option>
							<option value="PORCENTAJE">Porcentaje</option>
							<option value="NUMERICO">Numérico</option>
							<option value="TEXTO">Texto</option>
						</select>
					</div>
					<div class="mb-3">
						<div class="form-check">
							<input class="form-check-input" type="checkbox" formControlName="estado">
							<label class="form-check-label">Activo</label>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" (click)="closeModals()">Cancelar</button>
					<button type="submit" class="btn btn-primary" [disabled]="itemForm.invalid">
						{{ editingItem ? 'Actualizar' : 'Guardar' }}
					</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Modal Item de Cobro -->
<div class="modal fade" [class.show]="showModal" [style.display]="showModal ? 'block' : 'none'">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">{{ editingItem ? 'Editar' : 'Nuevo' }} Item de Cobro</h5>
				<button type="button" class="btn-close" (click)="closeModals()"></button>
			</div>
			<form [formGroup]="itemForm" (ngSubmit)="saveItem()">
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Nombre del Servicio *</label>
								<input type="text" class="form-control" formControlName="nombre_servicio">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Código Interno *</label>
								<input type="text" class="form-control" formControlName="codigo_producto_interno">
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Código Impuesto</label>
								<input type="text" class="form-control" formControlName="codigo_producto_impuesto">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Unidad de Medida *</label>
								<select class="form-select" formControlName="unidad_medida">
									<option value="">Seleccione</option>
									<option value="UNIDAD">Unidad</option>
									<option value="HORA">Hora</option>
									<option value="MES">Mes</option>
									<option value="SEMESTRE">Semestre</option>
								</select>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Costo</label>
								<input type="number" class="form-control" formControlName="costo">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Número de Créditos *</label>
								<input type="number" class="form-control" formControlName="nro_creditos">
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Actividad Económica *</label>
								<input type="text" class="form-control" formControlName="actividad_economica">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Tipo de Item *</label>
								<select class="form-select" formControlName="tipo_item">
									<option value="">Seleccione</option>
									<option value="SERVICIO">Servicio</option>
									<option value="PRODUCTO">Producto</option>
									<option value="MATERIA">Materia</option>
								</select>
							</div>
						</div>
					</div>
					<div class="mb-3">
						<label class="form-label">Descripción</label>
						<textarea class="form-control" formControlName="descripcion" rows="3"></textarea>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div class="form-check mb-3">
								<input class="form-check-input" type="checkbox" formControlName="facturado">
								<label class="form-check-label">Facturado</label>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-check mb-3">
								<input class="form-check-input" type="checkbox" formControlName="estado">
								<label class="form-check-label">Activo</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" (click)="closeModals()">Cancelar</button>
					<button type="submit" class="btn btn-primary" [disabled]="itemForm.invalid">
						{{ editingItem ? 'Actualizar' : 'Guardar' }}
					</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Modal Materia -->
<div class="modal fade" [class.show]="showModal" [style.display]="showModal ? 'block' : 'none'">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">{{ editingItem ? 'Editar' : 'Nueva' }} Materia</h5>
				<button type="button" class="btn-close" (click)="closeModals()"></button>
			</div>
			<form [formGroup]="itemForm" (ngSubmit)="saveItem()">
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Sigla *</label>
								<input type="text" class="form-control" formControlName="sigla">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label class="form-label">Pensum *</label>
								<input type="text" class="form-control" formControlName="pensum">
							</div>
						</div>
					</div>
					<div class="mb-3">
						<label class="form-label">Nombre *</label>
						<input type="text" class="form-control" formControlName="nombre">
					</div>
					<div class="row">
						<div class="col-md-4">
							<div class="mb-3">
								<label class="form-label">Créditos *</label>
								<input type="number" class="form-control" formControlName="creditos">
							</div>
						</div>
						<div class="col-md-4">
							<div class="mb-3">
								<label class="form-label">Horas Teóricas</label>
								<input type="number" class="form-control" formControlName="horas_teoricas">
							</div>
						</div>
						<div class="col-md-4">
							<div class="mb-3">
								<label class="form-label">Horas Prácticas</label>
								<input type="number" class="form-control" formControlName="horas_practicas">
							</div>
						</div>
					</div>
					<div class="mb-3">
						<label class="form-label">Descripción</label>
						<textarea class="form-control" formControlName="descripcion" rows="3"></textarea>
					</div>
					<div class="mb-3">
						<div class="form-check">
							<input class="form-check-input" type="checkbox" formControlName="estado">
							<label class="form-check-label">Activo</label>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" (click)="closeModals()">Cancelar</button>
					<button type="submit" class="btn btn-primary" [disabled]="itemForm.invalid">
						{{ editingItem ? 'Actualizar' : 'Guardar' }}
					</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Modal de Confirmación de Eliminación -->
<div class="modal fade" [class.show]="showDeleteModal" [style.display]="showDeleteModal ? 'block' : 'none'">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Confirmar Eliminación</h5>
				<button type="button" class="btn-close" (click)="closeModals()"></button>
			</div>
			<div class="modal-body">
				<p>¿Está seguro que desea eliminar este elemento?</p>
				<p class="text-muted">Esta acción no se puede deshacer.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" (click)="closeModals()">Cancelar</button>
				<button type="button" class="btn btn-danger" (click)="executeDelete()">Eliminar</button>
			</div>
		</div>
	</div>
</div>

<!-- Modal Backdrop -->
<div *ngIf="showModal || showDeleteModal" 
     class="modal-backdrop fade show" (click)="closeModals()"></div>
